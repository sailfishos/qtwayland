diff -ru qtwayland-opensource-src-5.0.0-beta1/src/compositor/hardware_integration/wayland_egl/waylandeglintegration.cpp qtwayland-opensource-src-5.0.0-beta1-fixeglfs/src/compositor/hardware_integration/wayland_egl/waylandeglintegration.cpp
--- qtwayland-opensource-src-5.0.0-beta1/src/compositor/hardware_integration/wayland_egl/waylandeglintegration.cpp	2012-08-28 19:41:35.000000000 +0000
+++ qtwayland-opensource-src-5.0.0-beta1-fixeglfs/src/compositor/hardware_integration/wayland_egl/waylandeglintegration.cpp	2012-11-30 09:49:44.901009760 +0000
@@ -121,14 +121,13 @@
     QPlatformNativeInterface *nativeInterface = QGuiApplication::platformNativeInterface();
     if (nativeInterface) {
         d->egl_display = nativeInterface->nativeResourceForWindow("EglDisplay", m_compositor->window());
+	if (!d->egl_display) {
+		d->egl_display = nativeInterface->nativeResourceForIntegration("EglDisplay");
+	}
         if (d->egl_display) {
             const char *extensionString = eglQueryString(d->egl_display, EGL_EXTENSIONS);
             if (extensionString && strstr(extensionString, "EGL_WL_bind_wayland_display"))
             {
-                d->get_egl_context = nativeInterface->nativeResourceFunctionForContext("get_egl_context");
-                if (!d->get_egl_context) {
-                    qWarning("Failed to retrieve the get_egl_context function");
-                }
                 d->egl_bind_wayland_display =
                         reinterpret_cast<PFNEGLBINDWAYLANDDISPLAYWL>(eglGetProcAddress("eglBindWaylandDisplayWL"));
                 d->egl_unbind_wayland_display =
@@ -141,7 +140,6 @@
                         reinterpret_cast<PFNGLEGLIMAGETARGETTEXTURE2DOESPROC>(eglGetProcAddress("glEGLImageTargetTexture2DOES"));
 
                 if (d->egl_bind_wayland_display
-                        && d->get_egl_context
                         && d->egl_unbind_wayland_display
                         && d->egl_create_image
                         && d->egl_destroy_image
@@ -167,7 +165,7 @@
     }
 
     QPlatformNativeInterface *nativeInterface = QGuiApplication::platformNativeInterface();
-    EGLContext egl_context = d->get_egl_context(context);
+    EGLContext egl_context = nativeInterface->nativeResourceForContext("eglcontext", context);
 
     EGLImageKHR image = d->egl_create_image(d->egl_display, egl_context,
                                           EGL_WAYLAND_BUFFER_WL,
@@ -234,7 +232,7 @@
     Q_D(const WaylandEglIntegration);
 
     QPlatformNativeInterface *nativeInterface = QGuiApplication::platformNativeInterface();
-    EGLContext egl_context = d->get_egl_context(context);
+    EGLContext egl_context = nativeInterface->nativeResourceForContext("eglcontext", context);
 
     EGLImageKHR image = d->egl_create_image(d->egl_display, egl_context,
                                           EGL_WAYLAND_BUFFER_WL,
